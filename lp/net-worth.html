<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-5SF9L94K');</script>
  <!-- End Google Tag Manager -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Free Net Worth Calculator - Track Your Wealth in 60 Seconds | SaveBest.org</title>
  <style>
    body { font-family: 'Helvetica Neue', sans-serif; background-color: #ffffff; margin: 0; padding: 0; color: #333; }
    .wizard-container { max-width: 480px; margin: 0 auto; padding: 2rem 1rem; background-color: #ffffff; text-align: center; }
    .logo img { max-width: 220px; height: auto; margin-bottom: 1.5rem; }
    .progress-bar { background-color: #e6e6e6; border-radius: 5px; overflow: hidden; height: 6px; margin-bottom: 1rem; }
    .progress-fill { background-color: #3f6b5d; width: 33.333%; height: 100%; transition: width 0.3s ease; }
    .progress-label { text-align: center; font-size: 0.9rem; color: #3f6b5d; margin-bottom: 1rem; height: 0; overflow: hidden; }
    .question { font-size: 1.4rem; font-weight: bold; margin-bottom: 0.5rem; color: #333; }
    .subtext { font-size: 0.95rem; color: #666; margin-bottom: 1.25rem; }
    .grid-buttons { display: flex; flex-direction: column; gap: 0.75rem; }
    .option-button, .submit-button { padding: 1rem; font-size: 1rem; background-color: #f5f5f5; color: #333; border: 2px solid #ddd; border-radius: 30px; cursor: pointer; font-weight: bold; transition: background-color 0.2s, border-color 0.2s; }
    .option-button:hover, .submit-button:hover { background-color: #e0e0e0; border-color: #3f6b5d; }
    .top-bar { display: flex; justify-content: space-between; align-items: center; font-size: 0.85rem; margin-bottom: 1rem; }
    .nav-links { display: flex; gap: 1rem; }
    .nav-links a { color: #888; text-decoration: none; cursor: pointer; }
    .hidden { display: none; }
    .email-input { padding: 0.8rem; font-size: 1rem; border-radius: 8px; border: 1px solid #ccc; margin-bottom: 1rem; width: 100%; }
    .fine-print { font-size: 0.75rem; color: #888; margin-top: 2rem; padding: 1rem; background-color: #f8f8f8; border-radius: 8px; line-height: 1.4; }
    .benefit-text { font-size: 0.9rem; color: #3f6b5d; font-weight: 500; margin-bottom: 1rem; }
    .urgency-text { font-size: 0.85rem; color: #d32f2f; font-weight: 500; margin-bottom: 1rem; }
    .help-tooltip { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border: 1px solid #ddd; border-radius: 8px; padding: 1.5rem; box-shadow: 0 4px 20px rgba(0,0,0,0.15); z-index: 1000; max-width: 400px; width: 90%; max-height: 80vh; overflow-y: auto; display: none; }
    .help-tooltip h3 { margin: 0 0 1rem 0; color: #3f6b5d; font-size: 1.1rem; }
    .help-tooltip p { margin: 0 0 1rem 0; line-height: 1.5; color: #555; }
    .help-tooltip .close-btn { position: absolute; top: 0.5rem; right: 0.5rem; background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #999; padding: 0.25rem; min-width: 2rem; min-height: 2rem; display: flex; align-items: center; justify-content: center; }
    .help-tooltip .close-btn:hover { color: #333; }
    .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 999; display: none; }
    
    /* Mobile-specific styles for tooltips */
    @media (max-width: 768px) {
      .help-tooltip { 
        width: 95%; 
        max-width: none; 
        padding: 1.25rem; 
        margin: 1rem; 
        top: 50%; 
        left: 50%; 
        transform: translate(-50%, -50%);
        max-height: 85vh;
      }
      .help-tooltip h3 { font-size: 1rem; }
      .help-tooltip p { font-size: 0.9rem; }
      .help-tooltip .close-btn { 
        top: 0.75rem; 
        right: 0.75rem; 
        font-size: 1.25rem; 
        min-width: 2.5rem; 
        min-height: 2.5rem; 
      }
    }
    
    @media (max-width: 480px) {
      .help-tooltip { 
        width: 98%; 
        padding: 1rem; 
        margin: 0.5rem; 
      }
      .help-tooltip h3 { font-size: 0.95rem; }
      .help-tooltip p { font-size: 0.85rem; }
    }
    
    /* Exit modal button styles */
    .exit-modal-buttons { 
      display: flex; 
      gap: 1rem; 
      margin-top: 1.5rem; 
      flex-direction: row; 
    }
    .exit-btn-secondary { 
      flex: 1; 
      background-color: #f5f5f5; 
      border: 2px solid #ddd; 
    }
    .exit-btn-primary { 
      flex: 1; 
      background-color: #3f6b5d; 
      color: white; 
      border: 2px solid #3f6b5d; 
    }
    
    /* Mobile styles for exit modal buttons */
    @media (max-width: 480px) {
      .exit-modal-buttons { 
        flex-direction: column; 
        gap: 0.75rem; 
      }
      .exit-btn-secondary, .exit-btn-primary { 
        padding: 1rem 0.75rem; 
        font-size: 0.95rem; 
      }
    }
  </style>
</head>
<body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5SF9L94K"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<div class="wizard-container">
  <div class="logo"><img src="/assets/logo.png" alt="SaveBest.org Logo"></div>

  <div class="top-bar">
    <div class="progress-label" id="progress-text"></div>
    <div class="nav-links">
      <a onclick="goPrev()" id="previous-link" class="hidden">Previous</a>
      <a onclick="showHelp()" style="cursor: pointer;">Help</a>
      <a onclick="showExitConfirm()" style="cursor: pointer;">Exit</a>
    </div>
  </div>

  <div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div>

  <div id="step-1" class="step">
    <div class="question">How do you currently track your finances?</div>
    <div class="subtext">This helps us recommend the right solution for your needs and experience level.</div>
    <div class="grid-buttons">
      <button class="option-button" onclick="nextStep('Spreadsheet')">Excel/Google Sheets</button>
             <button class="option-button" onclick="nextStep('Free Software')">Free Software</button>
      <button class="option-button" onclick="nextStep('Paid Software')">Paid Software</button>
      <button class="option-button" onclick="nextStep('I don\'t track my net worth')">I don't track anything</button>
    </div>
  </div>

  <div id="step-2" class="step hidden">
    <div class="question">What's your current liquid net worth?</div>
    <div class="subtext">Estimate your current liquid net worth (a guess is fine). Liquid means cash, savings, investments, and retirement accounts.</div>
    <div class="grid-buttons">
      <button class="option-button" onclick="selectAssets('<$10k')">&lt;$10k</button>
      <button class="option-button" onclick="selectAssets('$10kâ€“$50k')">$10kâ€“$50k</button>
      <button class="option-button" onclick="selectAssets('$50kâ€“$100k')">$50kâ€“$100k</button>
      <button class="option-button" onclick="selectAssets('$100kâ€“$500k')">$100kâ€“$500k</button>
      <button class="option-button" onclick="selectAssets('$500kâ€“$1m')">$500kâ€“$1m</button>
      <button class="option-button" onclick="selectAssets('$1m+')">$1m+</button>
    </div>
  </div>

  <div id="step-3" class="step hidden">
    <div class="logo"><img src="/assets/empower-logo.svg" alt="Empower Logo"></div>
    <div class="question" id="empower-recommendation">ðŸŽ¯ Perfect Match Found!</div>
    <div class="subtext" id="empower-subtext">Based on your ${assetRange} net worth, we recommend Empower's free net worth tracker. It's the #1 choice for users in your financial situation.</div>
    <div class="benefit-text">âœ“ Free forever â€¢ Syncs all accounts â€¢ Professional-grade insights</div>
    <div class="grid-buttons"><button class="option-button" onclick="redirectToEmpower()">Get Started Free â†’</button></div>
  </div>

  <div id="step-3-monarch" class="step hidden">
    <div class="logo"><img src="/assets/MonarchLogo.PNG" alt="Monarch Money Logo"></div>
    <div class="question" id="monarch-recommendation">ðŸŽ¯ Perfect Match Found!</div>
    <div class="subtext" id="monarch-subtext">Based on your ${assetRange} net worth, we recommend Monarch Money's comprehensive financial management platform. It's the ideal solution for users in your financial situation.</div>
    <div class="benefit-text">âœ“ All-in-one financial management â€¢ Beautiful interface â€¢ Expert insights</div>
    <div class="grid-buttons"><button class="option-button" onclick="redirectToMonarch()">Get Started â†’</button></div>
  </div>

  <div id="step-4" class="step hidden">
    <div class="question">Get Your Personalized Financial Roadmap</div>
    <div class="subtext" id="step4-subtext">We'll send you custom strategies to grow your net worth faster, plus exclusive access to our best money-saving tools.</div>
    <div class="benefit-text">âœ“ Weekly wealth-building tips â€¢ Exclusive tool access â€¢ No spam, unsubscribe anytime</div>
    <input type="email" placeholder="Enter your email address" class="email-input">
    <div class="grid-buttons"><button class="submit-button" onclick="submitEmail()">Get My Free Roadmap â†’</button></div>
  </div>

  <div class="fine-print">
    <strong>Disclosure:</strong> Most of the companies mentioned on this site compensate us in some way, whether an affiliate or direct relationship. This helps us keep our tools free. We only recommend products we genuinely believe will help you.
  </div>
</div>

<!-- Help Tooltip Overlay -->
<div class="overlay" id="overlay"></div>

<!-- Help Tooltip -->
<div class="help-tooltip" id="help-tooltip">
  <button class="close-btn" onclick="closeHelp()">&times;</button>
  <h3 id="help-title">Why are we asking this?</h3>
  <p id="help-content">Help content will appear here.</p>
</div>

<!-- Exit Confirmation Modal -->
<div class="help-tooltip" id="exit-confirm-modal">
  <button class="close-btn" onclick="closeExitConfirm()">&times;</button>
  <h3>Are you sure?</h3>
  <p>You're only a couple clicks away from setting up your net worth tracker!</p>
  <div class="exit-modal-buttons">
    <button class="option-button exit-btn-secondary" onclick="closeExitConfirm()">Back to Form</button>
    <button class="option-button exit-btn-primary" onclick="exitForm()">Exit</button>
  </div>
</div>

<script>
  // User ID System
  function generateUserId() {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
    let result = '';
    for (let i = 0; i < 20; i++) {
      result += chars.charAt(Math.floor(Math.random() * chars.length));
    }
    return result;
  }
  
  function getOrCreateUserId() {
    let userId = localStorage.getItem('sabeid');
    if (!userId) {
      userId = generateUserId();
      localStorage.setItem('sabeid', userId);
    }
    return userId;
  }
  
  // Initialize user ID on page load
  document.addEventListener('DOMContentLoaded', function() {
    const userId = getOrCreateUserId();
    console.log('User ID:', userId);
    
    // Track page load event
    if (typeof dataLayer !== 'undefined') {
      dataLayer.push({
        'event': 'page_view',
        'page_title': 'Net Worth Calculator',
        'page_location': window.location.href,
        'user_id': userId
      });
    }
  });
  
  let trackingMethod = '';
  let assetRange = '';
  let stepOrder = ['1'];
  let currentIndex = 0;

  function setStepOrder(order) { 
    stepOrder = order; 
    updateProgress(); 
  }

  function trackFormEvent(page, step, action, value) {
    const eventName = `form_${page}_${step}_${action}_${value}`;
    
    // Google Tag Manager - Push to dataLayer
    if (typeof dataLayer !== 'undefined') {
      dataLayer.push({
        'event': 'form_interaction',
        'event_category': 'lead_form',
        'event_label': eventName,
        'form_page': page,
        'form_step': step,
        'form_action': action,
        'form_value': value,
        'user_id': getOrCreateUserId(),
        'asset_range': assetRange,
        'tracking_method': trackingMethod
      });
    }
    
    // Console logging for development
    console.log('Form Event:', eventName);
    console.log('DataLayer Event:', {
      'event': 'form_interaction',
      'event_category': 'lead_form',
      'event_label': eventName,
      'form_page': page,
      'form_step': step,
      'form_action': action,
      'form_value': value
    });
  }

  function nextStep(value) { 
    if (value) {
      trackFormEvent('net-worth', '1', 'select', value);
      trackingMethod = value;
    }
    setStepOrder(['1','2']);
    goTo('2');
  }

  function selectAssets(value) {
    trackFormEvent('net-worth', '2', 'select', value);
    assetRange = value;
    const highValue = ['$100kâ€“$500k', '$500kâ€“$1m', '$1m+'];
    const lowValue = ['<$10k', '$10kâ€“$50k', '$50kâ€“$100k'];
    
    if (highValue.includes(value)) { 
      document.getElementById('empower-recommendation').textContent = `ðŸŽ¯ Perfect Match Found!`;
      document.getElementById('empower-subtext').textContent = `Based on your ${assetRange} net worth, we recommend Empower's free net worth tracker. It's the #1 choice for users in your financial situation.`;
      setStepOrder(['1','2','3','4']); 
      goTo('3'); 
    }
    else if (lowValue.includes(value)) { 
      document.getElementById('monarch-subtext').textContent = `Based on your ${assetRange} net worth, we recommend Monarch Money's comprehensive financial management platform. It's the ideal solution for users in your financial situation.`;
      setStepOrder(['1','2','3-monarch','4']); 
      goTo('3-monarch'); 
    }
    else { 
      setStepOrder(['1','2']); 
      goTo('2'); 
    }
  }

  function goTo(id) { 
    toggle(currentIndex, true); 
    const newIndex = stepOrder.indexOf(id); 
    currentIndex = newIndex === -1 ? currentIndex : newIndex; 
    toggle(currentIndex, false); 
    syncHash(stepOrder[currentIndex]); 
    updateProgress(); 
    
    // Update step 4 text with asset range if available
    if (id === '4' && assetRange) {
      const step4Subtext = document.getElementById('step4-subtext');
      if (step4Subtext) {
        step4Subtext.textContent = `We'll send you custom strategies to grow your ${assetRange} net worth faster, plus exclusive access to our best money-saving tools.`;
      }
    }
  }

  function goPrev() { if (currentIndex === 0) return; history.back(); }

  function toggle(index, hide) { const el = document.getElementById(`step-${stepOrder[index]}`); if (!el) return; el.classList[hide ? 'add' : 'remove']('hidden'); }

  function updateProgress() {
    const total = stepOrder.length;
    const at = currentIndex + 1;
    document.getElementById('progress-fill').style.width = `${(at / Math.max(total,3)) * 100}%`;
    const prevLink = document.getElementById('previous-link');
    if (currentIndex > 0) prevLink.classList.remove('hidden'); else prevLink.classList.add('hidden');
    
    // Track progress updates
    trackFormEvent('net-worth', 'progress', 'update', `${at}/${total}`);
  }

  function getGclid() {
    // Check URL parameters first
    const urlParams = new URLSearchParams(window.location.search);
    let gclid = urlParams.get('gclid');
    
    // If gclid found in URL, save it as a 90-day cookie
    if (gclid) {
      const expiryDate = new Date();
      expiryDate.setDate(expiryDate.getDate() + 90);
      document.cookie = `gclid=${gclid}; expires=${expiryDate.toUTCString()}; path=/; SameSite=Lax`;
    }
    
    // If not in URL, check cookies
    if (!gclid) {
      const cookies = document.cookie.split(';');
      for (let cookie of cookies) {
        const [name, value] = cookie.trim().split('=');
        if (name === 'gclid') {
          gclid = value;
          break;
        }
      }
    }
    
    return gclid || '';
  }

  function redirectToEmpower() {
    trackFormEvent('net-worth', '3', 'click', 'continue');
    
    // Track the redirect event
    if (typeof dataLayer !== 'undefined') {
      dataLayer.push({
        'event': 'redirect_click',
        'redirect_destination': 'empower',
        'user_id': getOrCreateUserId(),
        'asset_range': assetRange,
        'tracking_method': trackingMethod
      });
    }
    
    // Get user ID and gclid
    const sabeid = getOrCreateUserId();
    const gclid = getGclid();
    
    // Build the URL with parameters
    const baseUrl = 'https://track.flexlinkspro.com/g.ashx?foid=156074.13439.1058727&trid=1368848.157618&foc=16&fot=9999&fos=6';
    const url = `${baseUrl}&fobs=${sabeid}&fobs2=${gclid}`;
    
    window.open(url, '_blank');
    document.title = 'Level Up! Add Your Information to Advance';
    goTo('4');
  }

  function redirectToMonarch() {
    trackFormEvent('net-worth', '3-monarch', 'click', 'continue');
    
    // Track the redirect event
    if (typeof dataLayer !== 'undefined') {
      dataLayer.push({
        'event': 'redirect_click',
        'redirect_destination': 'monarch',
        'user_id': getOrCreateUserId(),
        'asset_range': assetRange,
        'tracking_method': trackingMethod
      });
    }
    
    // Get user ID and gclid
    const sabeid = getOrCreateUserId();
    const gclid = getGclid();
    
    // Build the URL with parameters for Monarch Money
    const baseUrl = 'https://www.monarchmoney.com/landing/affiliate-manage-finances';
    const url = `${baseUrl}?fobs=${sabeid}&fobs2=${gclid}`;
    
    window.open(url, '_blank');
    document.title = 'Level Up! Add Your Information to Advance';
    goTo('4');
  }

  function isValidEmail(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
  }

  function submitEmail() {
    const emailInput = document.querySelector('.email-input');
    const email = emailInput.value.trim();
    
    if (isValidEmail(email)) {
      trackFormEvent('net-worth', '4', 'submit', email);
      
      // Track email submission event
      if (typeof dataLayer !== 'undefined') {
        dataLayer.push({
          'event': 'email_submit',
          'email_provided': 'yes',
          'user_id': getOrCreateUserId(),
          'asset_range': assetRange,
          'tracking_method': trackingMethod
        });
      }
      
      // Store user preferences
      localStorage.setItem('savebest_user_preferences', JSON.stringify({
        asset_range: assetRange,
        tracking_method: trackingMethod,
        email: email
      }));
      // Here you would typically send the data to your backend
      alert('Thank you! We\'ll be in touch soon.');
    } else {
      trackFormEvent('net-worth', '4', 'invalid_email', email);
      
      // Track invalid email event
      if (typeof dataLayer !== 'undefined') {
        dataLayer.push({
          'event': 'email_submit',
          'email_provided': 'no',
          'email_error': 'invalid_format',
          'user_id': getOrCreateUserId(),
          'asset_range': assetRange,
          'tracking_method': trackingMethod
        });
      }
      
      alert('Please enter a valid email address.');
    }
  }

  function syncHash(stepId) { const desired = `#${stepId}`; if (location.hash !== desired) location.hash = desired; }

  // Help tooltip functionality
  function showHelp() {
    const helpContent = getHelpContent();
    document.getElementById('help-title').textContent = helpContent.title;
    document.getElementById('help-content').textContent = helpContent.content;
    document.getElementById('overlay').style.display = 'block';
    document.getElementById('help-tooltip').style.display = 'block';
  }

  function closeHelp() {
    document.getElementById('overlay').style.display = 'none';
    document.getElementById('help-tooltip').style.display = 'none';
  }

  function showExitConfirm() {
    document.getElementById('overlay').style.display = 'block';
    document.getElementById('exit-confirm-modal').style.display = 'block';
  }

  function closeExitConfirm() {
    document.getElementById('overlay').style.display = 'none';
    document.getElementById('exit-confirm-modal').style.display = 'none';
  }

  function exitForm() {
    // Track exit event
    trackFormEvent('net-worth', 'exit', 'confirm', 'user_exit');
    
    if (typeof dataLayer !== 'undefined') {
      dataLayer.push({
        'event': 'form_exit',
        'exit_reason': 'user_confirmed',
        'user_id': getOrCreateUserId(),
        'asset_range': assetRange,
        'tracking_method': trackingMethod
      });
    }
    
    // Redirect to exit page with financial tool options
    window.location.href = '/lp/nw-exit.html';
  }

  function getHelpContent() {
    const currentStep = stepOrder[currentIndex];
    const helpData = {
      '1': {
        title: "Why are we asking about your current tracking method?",
        content: "Understanding how you currently manage your finances helps us recommend the right solution. If you're using spreadsheets, you might need something more automated. If you're already using apps, we can suggest upgrades. If you're not tracking at all, we'll start with the basics."
      },
      '2': {
        title: "Why are we asking about your net worth?",
        content: "Your liquid net worth helps us recommend the most suitable financial tools for your situation. Different wealth levels have different needs - someone with $10k needs different advice than someone with $500k. This ensures you get personalized recommendations that actually work for your financial stage."
      },
      '3': {
        title: "Why are we recommending Empower?",
        content: "Based on your financial situation, Empower offers the best combination of features, ease of use, and value. It's free forever, syncs with all your accounts automatically, and provides professional-grade insights. We've tested dozens of tools and found this works best for users in your financial range."
      },
      '3-monarch': {
        title: "Why are we recommending Monarch Money?",
        content: "For users with under $100k net worth, Monarch Money provides the perfect balance of comprehensive features and ease of use. It's designed to help you build better financial habits and grow your wealth systematically. The platform offers beautiful insights and expert guidance tailored to your financial stage."
      },
      '4': {
        title: "Why are we asking for your email?",
        content: "We want to send you personalized strategies to grow your wealth faster. Based on your net worth and current situation, we'll share specific tips, tools, and opportunities that are most relevant to you. You can unsubscribe anytime, and we'll never spam you."
      }
    };
    return helpData[currentStep] || {
      title: "Help",
      content: "This is the help section for the current step."
    };
  }

  // Close tooltip when clicking overlay
  document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('overlay').addEventListener('click', function() {
      closeHelp();
      closeExitConfirm();
    });
  });

  window.addEventListener('hashchange', () => {
    const id = location.hash.replace('#','');
    const idx = stepOrder.indexOf(id);
    if (idx !== -1 && idx !== currentIndex) { toggle(currentIndex, true); currentIndex = idx; toggle(currentIndex, false); updateProgress(); }
  });

  if (!location.hash) syncHash(stepOrder[currentIndex]); else {
    const id = location.hash.replace('#','');
    if (stepOrder.includes(id)) { toggle(currentIndex, true); currentIndex = stepOrder.indexOf(id); toggle(currentIndex, false); }
    else syncHash(stepOrder[currentIndex]);
  }
  updateProgress();
</script>

</body>
</html>
